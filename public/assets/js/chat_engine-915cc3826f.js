class ChatEngine{constructor(e,s,n,i,a){this.chatBox=$(`#${e}`),this.userEmail=s,this.userName=n,this.userProfile=i,this.socket=io.connect(a,{transports:["websocket"],secure:!0,reconnect:!0,rejectUnauthorized:!1}),this.userEmail&&this.connectionHandler()}connectionHandler(){let e=this;this.socket.on("connect",(function(){e.socket.emit("join_room",{user_email:e.userEmail,user_name:e.userName,user_profile:e.userProfile,time:(new Date).toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"numeric"}),chatroom:"codeial"}),e.socket.on("user_joined",(function(e){}))})),$("#send-message").click((function(){let s=$("#chat-message-input").val();""!=s&&e.socket.emit("send_message",{message:s,user_email:e.userEmail,user_name:e.userName,user_profile:e.userProfile,time:(new Date).toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"numeric"}),chatroom:"codeial"})})),$("#chat-message-input").keypress((function(e){13==e.which&&$("#send-message").click()})),e.socket.on("receive_message",(function(s){let n=$("<li>");$("<img>");n.addClass("animate__animated  animate__fadeIn");let i="other-message animate__animated  animate__fadeIn";if(s.user_email==e.userEmail?(i="self-message",n.append(`<div class="msg-content">\n                                <span>\n                                    ${s.message} <sup>${s.time}</sup> \n                                </span>\n                                <img src="${s.user_profile}">\n                            </div>`)):n.append(`<div class="msg-content">\n                                <img src="${s.user_profile}">\n                                <span>\n                                    ${s.message} <sup>${s.time}</sup> \n                                </span>\n                                \n                            </div>`),$("#chat-messages-list li").length){let e=$("#chat-messages-list li:last-child");e.find("sub").html()==s.user_name&&(e.find("sub").remove(),e.find("img").css("visibility","hidden"),e.hasClass("self-message"),e.css("margin-bottom","0px"),n.css("margin-top","0px"))}n.append($("<sub>",{html:s.user_name})),n.addClass(i),$("#chat-messages-list").append(n),$("#chat-message-input").val("")}))}}